' ВНИМАНИЕ: Для рендеринга этой диаграммы требуется Graphviz
' Установка на macOS: brew install graphviz
' Альтернативная версия без Graphviz: Phase-1-C4-Context-Standard.puml

@startuml C4_Context
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title Диаграмма контекста: Система анализа аварийных сигналов

' Пользователи системы
Person(dispatcher, "Диспетчер ЕДС", "Мониторит аварийные сигналы, запускает анализ объектов")
Person(master, "Мастер ЦДНГ", "Просматривает результаты анализа, работает с рекомендациями")
Person(manager, "Руководство ЦДНГ", "Принимает решения по рекомендациям, управляет уставками")
Person(specialist, "Специалист отдела", "Анализирует рекомендации по замене оборудования")
Person(admin, "Администратор системы", "Управляет системой, настраивает интеграции")

' Центральная система
System(system, "Система анализа аварийных сигналов", "Автоматизирует анализ аварийных сигналов, проверяет уставки, генерирует рекомендации")

' Внешние системы
System_Ext(asdku, "АСДКУ", "Автоматизированная система диспетчерского контроля и управления. Источник данных параметров в реальном времени")
System_Ext(mega, "ИС «МЕГА»", "Информационная система. Источник исторических данных параметров")
System_Ext(protok, "ИС «Проток»", "Информационная система. Источник исторических данных параметров")
System_Ext(essd, "ЕССД", "Единая система сбора данных. Источник списка аварийных сигналов")
System_Ext(armits, "КИС «Армитс»", "Корпоративная информационная система. Источник объемов перекачки и прогнозов")
System_Ext(toir, "1С ТОиР", "Система технического обслуживания и ремонта. Источник метаданных оборудования")
System_Ext(sed, "СЭД", "Система электронного документооборота. Источник перечней блокировок и сигнализаций")
System_Ext(rd, "РД", "Руководящие документы. Источник нормативных требований")

' Взаимодействия пользователей с системой
Rel(dispatcher, system, "Просматривает дашборд, запускает анализ", "HTTPS")
Rel(master, system, "Просматривает результаты анализа, работает с рекомендациями", "HTTPS")
Rel(manager, system, "Принимает решения по рекомендациям, управляет уставками", "HTTPS")
Rel(specialist, system, "Анализирует рекомендации по оборудованию", "HTTPS")
Rel(admin, system, "Управляет системой, настраивает интеграции", "HTTPS")

' Интеграции с внешними системами
Rel(system, asdku, "Получает данные параметров в реальном времени", "REST API/OPC UA")
Rel(system, mega, "Получает исторические данные параметров", "REST API")
Rel(system, protok, "Получает исторические данные параметров", "REST API")
Rel(system, essd, "Получает список аварийных сигналов", "REST API/WebSocket")
Rel(system, armits, "Получает объемы перекачки и прогнозы", "REST API")
Rel(system, toir, "Получает метаданные оборудования", "REST API/Файловый обмен")
Rel(system, sed, "Получает перечни блокировок и сигнализаций", "REST API/Файловый обмен")
Rel(system, rd, "Читает нормативные требования", "Файловое хранилище")

' Стилизация
UpdateElementStyle(system, $bgColor="#4A90E2", $fontColor="#FFFFFF")
UpdateElementStyle(dispatcher, $bgColor="#E8F4F8", $fontColor="#2E5C8A")
UpdateElementStyle(master, $bgColor="#E8F4F8", $fontColor="#2E5C8A")
UpdateElementStyle(manager, $bgColor="#E8F4F8", $fontColor="#2E5C8A")
UpdateElementStyle(specialist, $bgColor="#E8F4F8", $fontColor="#2E5C8A")
UpdateElementStyle(admin, $bgColor="#E8F4F8", $fontColor="#2E5C8A")

@enduml

